#! /bin/bash

### START -------

$HOME/.config/polybar/forest/launch.sh &

flameshot & 

pgrep -x sxhkd > /dev/null | sxhkd &

nitrogen --restore &

dunst -config $HOME/.config/dunst/dunstrc_test04 &

picom &

#bluetooth applet
blueman-applet &

nm-applet & 
# remove cursor "x"
xsetroot -cursor_name left_ptr &

#greenclip copy history
killall -q greenclip
greenclip daemon &


monitor_remove() {
	# Add default temp desktop because a minimum of one desktop is required per monitor
	bspc monitor "$EXTERNAL_MONITOR" -a Desktop

  # Move all desktops except the last default desktop to internal monitor
  for desktop in $(bspc query -D -m "$EXTERNAL_MONITOR");	do
	  bspc desktop "$desktop" --to-monitor "$INTERNAL_MONITOR"
  done

  # delete default desktops
  bspc desktop Desktop --remove

  # reorder desktops
  bspc monitor "$INTERNAL_MONITOR" -o 1 2 3 4 5 6 7 8 9
}

INTERNAL_MONITOR=$(xrandr --listactivemonitors | awk 'NR==2{print $4}')
EXTERNAL_MONITOR=$(xrandr --listactivemonitors | awk 'NR==3{print $4}')

[ -z "$EXTERNAL_MONITOR" ] && EXTERNAL_MONITOR=HDMI-1

#INTERNAL_MONITOR="HDMI-1"
#EXTERNAL_MONITOR="eDP-1"
#INTERNAL_MONITOR="eDP-1"
#EXTERNAL_MONITOR="HDMI-1"

if [[ $(xrandr --listactivemonitors | grep "${EXTERNAL_MONITOR}") ]]; then
	bspc wm -O ${INTERNAL_MONITOR} ${EXTERNAL_MONITOR} 
	bspc monitor ${INTERNAL_MONITOR} -d 1 2 3 4 
	bspc monitor ${EXTERNAL_MONITOR} -d 5 6 7 8 9  
else
	bspc wm -O ${INTERNAL_MONITOR} 
	bspc monitor ${INTERNAL_MONITOR} -d  1 2 3 4 5 6 7 8 9
	monitor_remove
fi



#bspc config split_ratio          0.52
#bspc config borderless_monocle   true
#bspc config gapless_monocle      true

# --- Appearance --- #

bspc config window_gap          12
bspc config border_width         2
bspc config pointer_motion_interval    30

bspc config normal_border_color    "#7c6f64"
bspc config focused_border_color   "#fcb788"
bspc config active-border_color    "#a06943"



# --- Chrome --- #
#bspc rule -a Google-chrome                      desktop='^2'            follow=on  state=tiled 
bspc rule -a Google-chrome:*:'Open File'                                follow=on  state=floating rectangle=950x500+0+0
bspc rule -a Google-chrome:*:'Open Files'                               follow=on  state=floating rectangle=950x500+0+0
bspc rule -a Google-chrome:*:'Save File'                                follow=on  state=floating rectangle=950x500+0+0

 
# --- Teams --- #
#bspc rule -a microsoft teams - preview desktop='^5'

# --- Other apps --- #
bspc rule -a Pavucontrol                                     center=on  follow=on  state=floating rectangle=1600x850+0+0 

#bspc rule -a *:chrome desktop='^2'
#bspc rule -a google-chrome-unstable private=on dekstop=2
#bspc rule -a google-chrome-stable private=on dekstop=2
#bspc rule -a google-chrome-dev private=on dekstop=2
#bspc rule -a Gimp desktop='^8' state=floating follow=on
#bspc rule -a mplayer2 state=floating
#bspc rule -a Kupfer.py focus=on
#bspc rule -a Screenka manage=off
